# 🛒 쇼핑몰 장바구니 클린코드 리팩토링 프로젝트 개요

## 📋 프로젝트 소개

**목적**: 더티코드를 클린코드로 점진적 리팩토링하는 실습 프로젝트  
**주제**: 쇼핑몰 장바구니 시스템 (복잡한 비즈니스 로직 포함)  
**언어**: 바닐라 JavaScript → React + TypeScript (심화 단계)

---

## 🎯 핵심 목표

### 기본 과제 (현재 진행 중)
- `/src/basic/main.basic.js`의 더티코드를 클린코드로 개선
- **테스트 통과 필수**: `npm run test:basic` 항상 성공해야 함
- **점진적 리팩토링**: 한 번에 많은 변경 금지, 조금씩 개선
- React 전환을 고려한 구조 설계

### 심화 과제 (향후 계획)
- React + TypeScript로 기술 고도화
- 유지보수성 향상

---

## 📊 현재 리팩토링 진행 상황

### ✅ **완료된 작업**
1. **상수 분리**: 
   - `constants/productId.js` - 상품 ID 상수
   - `constants/shopPolicy.js` - 비즈니스 규칙 (할인율, 포인트 정책)

2. **컴포넌트 분리**:
   - `components/Header.js` - 헤더 UI
   - `components/ProductSelector.js` - 상품 선택 드롭다운
   - `components/CartDisplay/` - 장바구니 아이템 표시
   - `components/OrderSummary/` - 주문 요약 정보
   - `components/Manual/` - 도움말 모달

3. **서비스 분리**:
   - `services/lightningSale.js` - 번개세일 로직
   - `services/suggestSale.js` - 추천할인 로직

4. **유틸리티 분리**:
   - `utils/format.js` - 가격 포매팅 함수

### ⚠️ **개선이 필요한 부분**
1. **전역 변수**: `bonusPts`, `stockInfo`, `itemCnt`, `lastSel` 등
2. **긴 함수**: 
   - `handleCalculateCartStuff()` (102줄)
   - `doRenderBonusPoints()` (76줄)
3. **중복 로직**: DOM 조작, 계산 로직 중복
4. **복잡한 조건문**: 할인 정책 적용 부분

---

## 🧪 테스트 요구사항

### 필수 통과 테스트
- **상품 관리**: 5개 상품, 재고 관리, 품절 처리
- **할인 시스템**: 
  - 개별 할인 (상품별 10개 이상 시)
  - 대량 할인 (30개 이상 시 25%)
  - 화요일 할인 (10% 추가, 중복 적용)
- **포인트 적립**: 기본 0.1% + 화요일 2배 + 세트 보너스
- **UI/UX**: 레이아웃, 장바구니 카드, 도움말 모달
- **예외 처리**: 재고 부족, 빈 장바구니

### 스킵된 테스트 (타이머 이슈)
- 번개세일 (⚡) 관련 기능
- 추천할인 (💝) 관련 기능

---

## 🏗️ 애플리케이션 아키텍처

### 현재 구조
```
src/basic/
├── main.basic.js          # 메인 애플리케이션 로직
├── components/            # UI 컴포넌트들
│   ├── Header.js
│   ├── ProductSelector.js
│   ├── CartDisplay/
│   ├── OrderSummary/
│   └── Manual/
├── constants/             # 비즈니스 상수
│   ├── productId.js
│   └── shopPolicy.js
├── services/              # 비즈니스 서비스
│   ├── lightningSale.js
│   └── suggestSale.js
└── utils/                 # 유틸리티 함수
    └── format.js
```

### 컴포넌트 패턴
- **팩토리 함수**: `create*()` 함수로 DOM 요소 생성
- **이벤트 핸들링**: `setupEventListeners` 패턴 통일
- **상태 관리**: 전역 변수 기반 (개선 필요)

---

## 💰 비즈니스 로직 복잡도

### 상품 정보
| ID | 상품명 | 가격 | 재고 | 할인율(10개↑) |
|----|-------|------|------|--------------|
| p1 | 버그 없애는 키보드 | 10,000원 | 50개 | 10% |
| p2 | 생산성 폭발 마우스 | 20,000원 | 30개 | 15% |
| p3 | 거북목 탈출 모니터암 | 30,000원 | 20개 | 20% |
| p4 | 에러 방지 노트북 파우치 | 15,000원 | 0개 | 5% |
| p5 | 코딩할 때 듣는 Lo-Fi 스피커 | 25,000원 | 10개 | 25% |

### 할인 정책 (중복 적용 가능)
1. **개별 상품 할인**: 10개 이상 구매 시
2. **대량구매 할인**: 30개 이상 시 25% (개별 할인 무시)
3. **화요일 할인**: 10% 추가 (모든 할인과 중복)
4. **번개세일**: 20% 할인 (30초마다 랜덤)
5. **추천할인**: 5% 할인 (60초마다 랜덤)

### 포인트 적립 시스템
- **기본**: 최종 금액의 0.1%
- **화요일**: 기본 포인트 2배
- **세트 보너스**: 키보드+마우스 +50p, 풀세트 +100p
- **대량구매**: 10개↑ +20p, 20개↑ +50p, 30개↑ +100p

---

## 🔧 개발 명령어

### 개발 및 테스트
```bash
npm run start:basic        # 기본 버전 실행
npm run test:basic         # 기본 버전 테스트
npm run test              # 전체 테스트
npm run test:ui           # 테스트 UI 실행
```

### 코드 품질
```bash
npm run lint              # ESLint 검사
npm run lint:fix          # ESLint 자동 수정
npm run format            # Prettier 포맷팅
npm run format:check      # 포맷팅 검사
```

---

## 📚 학습 자료 (docs 폴더)

### 🎯 필수 문서
- **01-PRD.md**: 상세 요구사항 명세서 (비즈니스 규칙)
- **02-dirty-code-analysis.md**: 원본 더티코드 문제점 분석

### ✅ 권장 문서
- **04-practical-clean-code-guide.md**: 실전 클린코드 작성 가이드
- **03-cart-tailwind-evaluation.md**: 코드 품질 평가 기준

### 📖 참고 문서
- **05-clean-code-theory-lesson.md**: 클린코드 이론

---

## ⚡ 리팩토링 시 주의사항

### 반드시 지킬 것
1. **테스트 통과**: 모든 변경 후 `npm run test:basic` 실행
2. **점진적 개선**: 한 번에 최대 1-2개 함수만 수정
3. **DOM 구조 유지**: 테스트가 CSS 셀렉터에 의존
4. **기능 동일성**: 기존 기능과 100% 동일하게 동작

### 우선순위 개선 영역
1. **전역 변수 제거** → 상태 관리 개선
2. **긴 함수 분할** → 단일 책임 원칙 적용
3. **중복 코드 제거** → DRY 원칙 적용
4. **의미 있는 이름** → 가독성 향상

---

## 🎪 특별한 도전 요소

### 복잡한 계산 로직
- 다중 할인 정책의 우선순위와 중복 적용
- 실시간 포인트 계산 (여러 보너스 조건)
- 재고 관리와 UI 동기화

### 타이머 기반 이벤트
- 번개세일: 0~10초 후 시작, 30초 간격
- 추천할인: 0~20초 후 시작, 60초 간격
- 동시 적용 시 25% SUPER SALE

### 반응형 UI
- Tailwind CSS 기반 디자인
- 모달, 카드, 애니메이션 효과
- 실시간 상태 표시

---

## 🚀 성공 지표

이 프로젝트가 성공적으로 완료되면:
- **클린코드 원칙 체득**: 변수 인접성, 단일 책임, DRY 등
- **리팩토링 기술 습득**: 점진적 개선 방법론
- **테스트 주도 개발**: 테스트를 통한 안전한 리팩토링
- **React 전환 준비**: 컴포넌트 기반 사고방식

---

**💡 Tips**: 
- 의문이 생기면 테스트를 먼저 확인하세요
- 큰 변경보다는 작은 개선을 반복하세요
- docs 폴더의 가이드를 자주 참고하세요
- 각 단계마다 테스트를 실행하는 습관을 기르세요